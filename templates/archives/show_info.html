{% extends 'base.html' %}

{% block title %}Show Info - Perfect Line Archives{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4">
    <header class="text-center mb-12">
        <h1 class="text-3xl md:text-4xl font-bold text-white">Show Information</h1>
        <p class="text-md md:text-lg text-gray-400 mt-2">Where to watch The Perfect Line.</p>
    </header>

    <!-- National Section -->
    <section class="mb-12">
        <h2 class="text-2xl font-bold text-white mb-4">Nationally</h2>
        <p class="text-gray-300">
            The Perfect Line can be seen nationally on <a href="https://www.gameshownetwork.com/the-perfect-line" target="_blank" rel="noopener noreferrer" class="font-semibold text-yellow-400 hover:underline">The Game Show Network</a> weeknights at 5:30 PM.
        </p>
    </section>

    <!-- Syndication Section -->
    <section class="mb-12">
        <h2 class="text-2xl font-bold text-white mb-4">Syndication</h2>
        <p class="text-gray-400 mb-6">
            The Perfect Line can also be seen in local markets around the country. Select your state below to find local listings.
        </p>

        <div class="bg-gray-800 rounded-2xl p-6 border border-gray-700">
            <!-- State Selector Dropdown -->
            <div class="mb-6">
                <label for="stateSelector" class="block mb-2 text-sm font-medium text-gray-300">Select a State:</label>
                <select id="stateSelector" class="bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5">
                    <option selected value="">-- Choose your state --</option>
                    {% for state in states %}
                        <option value="{{ state }}">{{ state }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Results Table Container -->
            <div id="resultsContainer" class="hidden">
                <div class="overflow-hidden rounded-lg border border-gray-700">
                    <table class="min-w-full divide-y divide-gray-700">
                        <thead class="bg-gray-700/50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">City</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Station</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Time(s)</th>
                            </tr>
                        </thead>
                        <tbody id="resultsBody" class="divide-y divide-gray-700">
                            <!-- Rows will be inserted here by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
             <div id="noResults" class="hidden text-center text-gray-500 p-4">
                <p>No syndication data found for the selected state.</p>
            </div>
        </div>
    </section>

    <!-- Links Section -->
    <section>
        <h2 class="text-2xl font-bold text-white mb-4">Links</h2>
        <div class="bg-gray-800 rounded-2xl p-6 border border-gray-700 space-y-8">
            <!-- Game Show Network -->
            <div>
                <h3 class="text-xl font-semibold text-white mb-3 border-b border-gray-700 pb-2">Game Show Network</h3>
                <ul class="space-y-2 mt-3">
                    <li><a href="https://www.gameshownetwork.com/the-perfect-line" target="_blank" rel="noopener noreferrer" class="text-gray-300 hover:text-yellow-400 hover:underline transition-colors">The Perfect Line Website</a></li>
                </ul>
            </div>
            <!-- The Perfect Line -->
            <div>
                <h3 class="text-xl font-semibold text-white mb-3 border-b border-gray-700 pb-2">The Perfect Line</h3>
                <ul class="space-y-2 mt-3">
                    <li><a href="https://www.instagram.com/perfectlinegameshow/" target="_blank" rel="noopener noreferrer" class="text-gray-300 hover:text-yellow-400 hover:underline transition-colors">Instagram</a></li>
                    <li><a href="https://www.facebook.com/perfectlinegameshow" target="_blank" rel="noopener noreferrer" class="text-gray-300 hover:text-yellow-400 hover:underline transition-colors">Facebook</a></li>
                    <li><a href="https://x.com/DeborahNorville" target="_blank" rel="noopener noreferrer" class="text-gray-300 hover:text-yellow-400 hover:underline transition-colors">Twitter</a></li>
                </ul>
            </div>
            <!-- Deborah Norville -->
            <div>
                <h3 class="text-xl font-semibold text-white mb-3 border-b border-gray-700 pb-2">Deborah Norville</h3>
                <ul class="space-y-2 mt-3">
                    <li><a href="https://www.instagram.com/deborahnorville/" target="_blank" rel="noopener noreferrer" class="text-gray-300 hover:text-yellow-400 hover:underline transition-colors">Instagram</a></li>
                    <li><a href="https://www.facebook.com/OfficialDeborahNorville" target="_blank" rel="noopener noreferrer" class="text-gray-300 hover:text-yellow-400 hover:underline transition-colors">Facebook</a></li>
                </ul>
            </div>
        </div>
    </section>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const stateSelector = document.getElementById('stateSelector');
        const resultsContainer = document.getElementById('resultsContainer');
        const noResultsDiv = document.getElementById('noResults');
        const resultsBody = document.getElementById('resultsBody');

        // The syndication data is passed from the Django view as a JSON string
        const syndicationData = JSON.parse('{{ syndication_data_json|safe }}');

        stateSelector.addEventListener('change', (event) => {
            const selectedState = event.target.value;

            // Clear previous results
            resultsBody.innerHTML = '';
            resultsContainer.classList.add('hidden');
            noResultsDiv.classList.add('hidden');

            if (selectedState && syndicationData[selectedState]) {
                const stations = syndicationData[selectedState];

                if (stations.length > 0) {
                    stations.forEach(station => {
                        const row = `
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-white">${station.city}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">${station.station}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">${station.time}</td>
                            </tr>
                        `;
                        resultsBody.innerHTML += row;
                    });
                    resultsContainer.classList.remove('hidden');
                } else {
                    noResultsDiv.classList.remove('hidden');
                }
            } else if (selectedState) {
                noResultsDiv.classList.remove('hidden');
            }
        });
    });
</script>
{% endblock %}

